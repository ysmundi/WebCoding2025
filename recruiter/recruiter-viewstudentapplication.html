<!DOCTYPE html><!--  This site was created in Webflow. https://webflow.com  --><!--  Last Published: Wed Feb 26 2025 15:50:37 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="67af6e67a671a041b4f6b321" data-wf-site="676715cb815e8f01731dca22">
<head>
  <meta charset="utf-8">
  <title>Recruiter_ViewStudentApplication</title>
  <meta content="Recruiter_ViewStudentApplication" property="og:title">
  <meta content="Recruiter_ViewStudentApplication" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="../css/normalize.css" rel="stylesheet" type="text/css">
  <link href="../css/webflow.css" rel="stylesheet" type="text/css">
  <link href="../css/yuvraj-webcoding-24-25.webflow.css" rel="stylesheet" type="text/css">
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="../images/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="../images/webclip.png" rel="apple-touch-icon">
  <script src="../js/config.js"></script>

  <style>
    /* Remove underline from the Back button */
    .back-button {
      text-decoration: none; /* Removes underline */
    }
  </style>
</head>
<body>
  <div class="w-layout-blockcontainer container-342 w-container">
    <div class="w-layout-blockcontainer container-149 w-container">
      <div class="w-layout-blockcontainer container-164 w-container">
        <a class="back-button">
          <div class="text-block-25">BACK</div>
        </a>
      </div>
    </div>
    <h1 class="heading-21">APPLICATION</h1>
    <div class="w-layout-blockcontainer container-150 w-container"></div>
  </div>
  <section class="section-27">
    <div class="w-layout-blockcontainer container-151 w-container">
      <div class="w-layout-blockcontainer container-154 w-container">
        <h1 class="heading-81">Basic Information</h1>
        <div class="text-block-104" id="organization">University of Harvard</div>
        <h1 class="heading-86" id="position">LECTURER</h1>
        <div class="text-block-105" id="education_requirements">Master Degree in Theoretical Physics</div>
        <div class="w-layout-blockcontainer container-155 w-container">
          <div class="w-layout-blockcontainer container-159 w-container">
            <div class="text-block-26">Position Type</div>
          </div>
          <div class="w-layout-blockcontainer container-343 w-container">
            <div class="text-block-27">On Site</div>
          </div>
        </div>
        <div class="w-layout-blockcontainer container-156 w-container">
          <div class="w-layout-blockcontainer container-161 w-container">
            <div class="text-block-107" >Location</div>
          </div>
          <div class="w-layout-blockcontainer container-162 w-container">
            <div class="text-block-28" id="location"><strong class="bold-text-29">Cambridge, MA</strong></div>
          </div>
        </div>
        <div class="w-layout-blockcontainer container-156 w-container">
          <div class="w-layout-blockcontainer container-161 w-container">
            <div class="text-block-108">Salary</div>
          </div>
          <div class="w-layout-blockcontainer container-162 w-container">
            <div><strong class="bold-text-6" id="salary">$110,000/Hr</strong></div>
          </div>
        </div>
        <div class="w-layout-blockcontainer container-156 w-container">
          <div class="w-layout-blockcontainer container-161 w-container">
            <div class="text-block-106">Deadline of Contract</div>
          </div>
          <div class="w-layout-blockcontainer container-162 w-container">
            <div><strong class="bold-text-7" id="deadline">2024 - 2029</strong></div>
          </div>
        </div>
        <h1 class="heading-82">Requirements</h1>
        <p class="paragraph-20" id="requirements">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare, eros dolor interdum nulla, ut commodo diam libero vitae erat. Aenean faucibus nibh et justo cursus id rutrum lorem imperdiet. Nunc ut sem vitae risus tristique posuere.</p>
        <h1 class="heading-83">About</h1>
        <p class="paragraph-22" id="about">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare, eros dolor interdum nulla, ut commodo diam libero vitae erat. Aenean faucibus nibh et justo cursus id rutrum lorem imperdiet. Nunc ut sem vitae risus tristique posuere.Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare, eros </p>
      </div>
      <div class="w-layout-blockcontainer container-152 w-container">
        <div class="w-layout-blockcontainer container-251 w-container">
          <div class="w-layout-blockcontainer container-264 w-container">
            <h1 class="heading-54">APPLICATION</h1>
          </div>
          <div class="w-layout-blockcontainer container-265 w-container">
            <div class="text-block-62" id="name">John Doe</div>
            <div class="text-block-63" id="email">johndoe@gmail.com</div>
            <div class="text-block-64" id="phone_number">845-121-1212</div>
            <div class="w-layout-blockcontainer container-266 w-container">
              <div class="text-block-69">View John Doe&#x27;s Profile</div>
              <a class="button-18 w-button" id="view">View</a>
            </div>
            <div class="text-block-70">John Doe&#x27;s Message</div>
            <p class="paragraph-18" id="about_you">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare, eros dolor interdum nulla, ut commodo diam libero vitae erat. Aenean faucibus nibh et justo cursus id rutrum lorem imperdiet. Nunc ut sem vitae risus tristique posuere.</p>
            <div class="w-layout-blockcontainer container-263 w-container">
              <a href="#" class="button-16 w-button" id="reject-button">Decline</a>
              <a href="#" class="button-17 w-button" id="accept-button">Accept</a>
            </div>
          </div>
        </div>
        <h1 class="heading-84">Nice To Have</h1>
        <p class="paragraph-21" id="nice-to-have">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare, eros dolor interdum nulla, ut commodo diam libero vitae erat. Aenean faucibus nibh et justo cursus id rutrum lorem imperdiet. Nunc ut sem vitae risus tristique posuere.</p>
        <h1 class="heading-85">Why work with us?</h1>
        <p class="paragraph-24" id="why-work-with-us">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare, eros dolor interdum nulla, ut commodo diam libero vitae erat. Aenean faucibus nibh et justo cursus id rutrum lorem imperdiet. Nunc ut sem vitae risus tristique posuere.</p>
      </div>
    </div>
    <div class="w-layout-blockcontainer container-291 w-container">
      <div class="w-layout-blockcontainer container-154 w-container">
        <h1>Basic Information</h1>
        <div id="organization_name">University of Harvard</div>
        <h1 class="heading-29"><span class="text-span-7" id="position">LECTURER</span></h1>
        <div>Master Degree in Theoretical Physics</div>
        <div class="w-layout-blockcontainer container-155 w-container">
          <div class="w-layout-blockcontainer container-159 w-container">
            <div class="text-block-26">Position Type</div>
          </div>
          <div class="w-layout-blockcontainer container-160 w-container">
            <div class="text-block-27" id="position_type">On Site</div>
          </div>
        </div>
        <div class="w-layout-blockcontainer container-156 w-container">
          <div class="w-layout-blockcontainer container-161 w-container">
            <div>Location</div>
          </div>
          <div class="w-layout-blockcontainer container-162 w-container">
            <div class="text-block-28" id="location"><strong>Cambridge, MA</strong></div>
          </div>
        </div>
        <div class="w-layout-blockcontainer container-156 w-container">
          <div class="w-layout-blockcontainer container-161 w-container">
            <div>Salary</div>
          </div>
          <div class="w-layout-blockcontainer container-162 w-container">
            <div><strong class="bold-text-6" >$110,000/Hr</strong></div>
          </div>
        </div>
        <div class="w-layout-blockcontainer container-156 w-container">
          <div class="w-layout-blockcontainer container-161 w-container">
            <div>Deadline</div>
          </div>
          <div class="w-layout-blockcontainer container-162 w-container">
            <div><strong class="bold-text-7" id="deadline">2024 - 2029</strong></div>
          </div>
        </div>
        <h1 class="heading-68">Requirements</h1>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare, eros dolor interdum nulla, ut commodo diam libero vitae erat. Aenean faucibus nibh et justo cursus id rutrum lorem imperdiet. Nunc ut sem vitae risus tristique posuere.</p>
        <h1 class="heading-67">About</h1>
        <p >Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare, eros dolor interdum nulla, ut commodo diam libero vitae erat. Aenean faucibus nibh et justo cursus id rutrum lorem imperdiet. Nunc ut sem vitae risus tristique posuere.Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare, eros </p>
      </div>
      <div class="w-layout-blockcontainer container-152 w-container">
        <h1>Nice To Have</h1>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare, eros dolor interdum nulla, ut commodo diam libero vitae erat. Aenean faucibus nibh et justo cursus id rutrum lorem imperdiet. Nunc ut sem vitae risus tristique posuere.</p>
        <h1>Why work with us?</h1>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare, eros dolor interdum nulla, ut commodo diam libero vitae erat. Aenean faucibus nibh et justo cursus id rutrum lorem imperdiet. Nunc ut sem vitae risus tristique posuere.</p>
        <div class="w-layout-blockcontainer container-251 w-container">
          <div class="w-layout-blockcontainer container-264 w-container">
            <h1 class="heading-54">APPLICATION</h1>
          </div>
        </div>
      </div>
    </div>
    <div class="w-layout-blockcontainer container-153 w-container">
      <h1 class="heading-61">Responsibilities</h1>
      <p id="responsibilities">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare, eros dolor interdum nulla, ut commodo diam libero vitae erat. Aenean faucibus nibh et justo cursus id rutrum lorem imperdiet. Nunc ut sem vitae risus tristique posuere.</p>
    </div>
  </section>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=676715cb815e8f01731dca22" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="../js/webflow.js" type="text/javascript"></script>
  <script>
    // Function to extract query parameters from the URL
    function getQueryParam(param) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);
    }

    // Function to check if a session ID exists
    function checkSession() {
        return $.ajax({
            url: `${config.apiBaseUrl}/auth/api/user`,
            method: 'GET',
            credentials: 'include', // Include cookies
            success: function (data) {
                console.log('Session Data:', data); // Log the API response

                // Redirect to index.html if no session ID is found or the user is not a recruiter
                if (!data.user || !data.user.id || data.user.role !== "Recruiter") {
                    window.location.href = '../index.html';
                }
                userId = data.user.id; // Store the user ID
            },
            error: function (error) {
                // Redirect to index.html if there's an error (e.g., no session)
                window.location.href = '../index.html';
                console.error('Error fetching user ID:', error);
            },
        });
    }

    // Function to fetch data from the API
    async function fetchJobDetails() {
        const applicationId = getQueryParam('applicationId'); // Get the application ID from the URL

        if (!applicationId) {
            console.error('Application ID not found in the URL');
            document.getElementById('error-message').textContent = 'Application ID not found in the URL.';
            return;
        }

        console.log('Fetching application details for applicationId:', applicationId);

        try {
            // Fetch application details
            const response = await fetch(`${config.apiBaseUrl}/jobs/application-info/${applicationId}`);
            if (!response.ok) {
                throw new Error('Failed to fetch application details');
            }
            const data = await response.json();
            console.log('Application Data:', data);

            // Check if the response contains an error
            if (data.error) {
                console.error('API Error:', data.error);
                return;
            }

            const application = data[0];

            // Update the HTML with the fetched data
            document.getElementById('name').textContent = application.username || 'None';
            document.getElementById('email').textContent = application.email || 'None';
            document.getElementById('phone_number').textContent = application.phone_number || 'None';
            document.getElementById('about_you').textContent = application.about_you || 'None';

            // Fetch job details
            const second = await fetch(`${config.apiBaseUrl}/recruiter/posting-info/${application.job_id}`);
            if (!second.ok) {
                throw new Error('Failed to fetch job details');
            }
            const data_2 = await second.json();
            console.log('Job Details Data:', data_2);

            // Check if the response is an array and has at least one element
            if (Array.isArray(data_2) && data_2.length > 0) {
                const job = data_2[0]; // Access the first job in the array

                // Update the HTML with the fetched data
                document.getElementById('organization_name').textContent = job.organization_name || 'None';
                document.getElementById('position').textContent = job.position_name || 'None';
                document.getElementById('education_requirements').textContent = job.education_requirements || 'None.';
                document.getElementById('position_type').textContent = job.job_type || 'None';
                document.getElementById('location').textContent = job.location_requirements || 'None';
                document.getElementById('salary').textContent = job.salary ? `$${job.salary}/Hr` : 'None';
                document.getElementById('deadline').textContent = job.deadline ? new Date(job.deadline).toLocaleDateString() : 'None';
                document.getElementById('requirements').textContent = job.requirements || 'No requirements available.';
                document.getElementById('responsibilities').textContent = job.responsibilities || 'No responsibilities available.';
                document.getElementById('about').textContent = job.about || 'No about information available.';
                document.getElementById('nice-to-have').textContent = job.nice_to_have || 'No nice-to-have information available.';
                document.getElementById('why-work-with-us').textContent = job.why_work_with_us || 'No information available.';
                // Store the job_id for later use
                window.jobId = job.job_id;
            } else {
                throw new Error('No job data found in the response');
            }
        } catch (error) {
            console.error('Error fetching job details:', error);
            document.getElementById('error-message').textContent = 'Failed to fetch job details.';
        }
    }

    async function viewStudentsProfile() {
    const applicationId = getQueryParam('applicationId'); // Get the application ID from the URL

    if (!applicationId) {
        console.error('Application ID not found in the URL');
        document.getElementById('error-message').textContent = 'Application ID not found in the URL.';
        return;
    }

    console.log('Fetching application details for applicationId:', applicationId);

    try {
        // Fetch application details
        const response = await fetch(`${config.apiBaseUrl}/jobs/application-info/${applicationId}`);
        if (!response.ok) {
            throw new Error('Failed to fetch application details');
        }
        const data = await response.json();
        console.log('Application Data:', data);

        // Check if the response contains an error
        if (data.error) {
            console.error('API Error:', data.error);
            return;
        }

        const userId = data[0].user_id;
        window.location.href = `recruiter-viewstudentprofile.html?userId=${userId}`;
    } catch (err) {
        console.error('Error fetching application details:', err);
        document.getElementById('error-message').textContent = 'Failed to fetch application details.';
    }
}


    // Call the function when the page loads
    document.addEventListener('DOMContentLoaded', function () {
        checkSession().then(fetchJobDetails);

        // Get the application ID from the URL
        const applicationId = getQueryParam('applicationId');

        // Add event listener for the Accept button
        const acceptButton = document.getElementById('accept-button');
        if (acceptButton) {
            acceptButton.addEventListener('click', function (event) {
                event.preventDefault(); // Prevent the default link behavior
                acceptApplication(applicationId);
            });
        } else {
            console.error('Accept button not found');
        }

        // Add event listener for the Reject button
        const rejectButton = document.getElementById('reject-button');
        if (rejectButton) {
            rejectButton.addEventListener('click', function (event) {
                event.preventDefault(); // Prevent the default link behavior
                rejectApplication(applicationId);
            });
        } else {
            console.error('Reject button not found');
        }

        const viewStudentPage = document.getElementById('view');
        if (viewStudentPage) {
            viewStudentPage.addEventListener('click', function (event) {
                event.preventDefault();
                viewStudentsProfile(); // Call the correct function
            });
        }
    });

    // Function to accept an application
    function acceptApplication(applicationId) {
        const jobId = window.jobId; // Retrieve the job_id from the global scope
        if (!jobId) {
            console.error('Job ID not found');
            alert('Job ID is missing. Please refresh the page and try again.');
            return;
        }

        $.ajax({
            url: `${config.apiBaseUrl}/recruiter/accept-application/${applicationId}`,
            method: 'PUT',
            success: function (response) {
                console.log('Application accepted:', response.message);
                alert('Application accepted successfully!');
                // Redirect to the project info page with the job_id
                window.location.href = `recruiter-projectinfo.html?jobId=${jobId}`;
            },
            error: function (error) {
                console.error('Error accepting application:', error.responseJSON.error);
                alert('Failed to accept application. Please try again.');
            },
        });
    }

    // Function to reject an application
    function rejectApplication(applicationId) {
        const jobId = window.jobId; // Retrieve the job_id from the global scope
        if (!jobId) {
            console.error('Job ID not found');
            alert('Job ID is missing. Please refresh the page and try again.');
            return;
        }

        $.ajax({
            url: `${config.apiBaseUrl}/recruiter/reject-application/${applicationId}`,
            method: 'PUT',
            success: function (response) {
                console.log('Application rejected:', response.message);
                alert('Application rejected successfully!');
                // Redirect to the project info page with the job_id
                window.location.href = `recruiter-projectinfo.html?jobId=${jobId}`;
            },
            error: function (error) {
                console.error('Error rejecting application:', error.responseJSON.error);
                alert('Failed to reject application. Please try again.');
            },
        });
    }
</script>
  
</body>
</html>