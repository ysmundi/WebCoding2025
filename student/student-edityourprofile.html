<!DOCTYPE html><!--  This site was created in Webflow. https://webflow.com  --><!--  Last Published: Fri Feb 28 2025 01:01:10 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="67ba4894521bc187f490b2f7" data-wf-site="676715cb815e8f01731dca22">
<head>
  <meta charset="utf-8">
  <title>Student_EditYourProfile</title>
  <meta content="Student_EditYourProfile" property="og:title">
  <meta content="Student_EditYourProfile" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="../css/normalize.css" rel="stylesheet" type="text/css">
  <link href="../css/webflow.css" rel="stylesheet" type="text/css">
  <link href="../css/yuvraj-webcoding-24-25.webflow.css" rel="stylesheet" type="text/css">
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="../images/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="../images/webclip.png" rel="apple-touch-icon">
  <script src="../js/config.js"></script>
</head>
<body>
  <section class="section-32">
    <div class="w-layout-blockcontainer container-228 w-container">
      <div class="w-layout-blockcontainer container-229 w-container">
        <a href="../student/student-yourprofile.html" class="link-block-10 w-inline-block">
          <div class="text-block-25">BACK</div>
        </a>
      </div>
      <div class="w-layout-blockcontainer container-230 w-container">
        <h1 class="heading-21"> Edit Your Profile</h1>
      </div>
      <div class="w-layout-blockcontainer container-231 w-container"></div>
    </div>
  </section>
  <div class="w-layout-blockcontainer container-232 w-container">
    <div class="w-layout-blockcontainer container-289 w-container">
      <h1 class="heading-3">Information</h1>
    </div>
    <div class="form-block-8 w-form">
      <form id="email-form" name="email-form" data-name="Email Form" redirect="/student/student-yourprofile" data-redirect="/student/student-yourprofile" method="get" class="form-7" data-wf-page-id="67ba4894521bc187f490b2f7" data-wf-element-id="d3e658e0-4252-bca9-5098-5410af087131">
        <div class="w-layout-blockcontainer container-233 w-container">
          <div class="w-layout-blockcontainer container-234 w-container">
            <div class="w-layout-blockcontainer container-305 w-container">
              <div class="text-block-54">First name:</div><input class="text-field-20 w-input" maxlength="256" name="field" data-name="Field" placeholder="Example Text" type="text" id="first-name">
            </div>
            <div class="w-layout-blockcontainer container-305 w-container">
              <div class="text-block-54">Last name:</div><input class="text-field-20 w-input" maxlength="256" name="field" data-name="Field" placeholder="Example Text" type="text" id="last-name">
            </div>
            <div class="w-layout-blockcontainer container-306 w-container"><input type="submit" data-wait="Please wait..." class="submit-button-7 w-button" value="DONE"></div>
          </div>
          <div class="w-layout-blockcontainer container-235 w-container">
            <div class="text-block-54">Date ofÂ Birth:</div><input class="text-field-21 w-input" maxlength="256" name="field-2" data-name="Field 2" placeholder="Example Text" type="date" id="date-of-birth">
          </div>
          <div class="w-layout-blockcontainer container-236 w-container">
            <div class="text-block-54">Education:</div><input class="text-field-21 w-input" maxlength="256" name="field-2" data-name="Field 2" placeholder="Example Text" type="text" id="education">
          </div>
          <div class="w-layout-blockcontainer container-237 w-container">
            <div class="text-block-54">Location:</div><input class="text-field-21 w-input" maxlength="256" name="field-2" data-name="Field 2" placeholder="Example Text" type="text" id="location">
          </div>
          <div class="w-layout-blockcontainer container-238 w-container">
            <div class="text-block-54">Language:</div><input class="text-field-21 w-input" maxlength="256" name="field-2" data-name="Field 2" placeholder="Example Text" type="text" id="language">
          </div>
          <div class="w-layout-blockcontainer container-241 w-container">
            <div class="text-block-54">Preferred Job Type:</div><select id="job_type" name="field-3" data-name="Field 3" class="select-field-15 w-select">
              <option value="None">None</option>
              <option value="Remote">Remote</option>
              <option value="On-Site">On-Site</option>
            </select>
          </div>
          <div class="w-layout-blockcontainer container-245 w-container">
            <div class="text-block-54">Bio:</div><textarea placeholder="Example Text" maxlength="5000" id="bio" name="field-4" data-name="Field 4" class="textarea-3 w-input"></textarea>
          </div>
        </div>
      </form>
    </div>
  </div>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=676715cb815e8f01731dca22" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="../js/webflow.js" type="text/javascript"></script>
  <script>
    // Function to get query parameters from the URL
    function getQueryParam(param) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(param);
    }
  
    // Function to check if a session ID exists
    function checkSession() {
      return $.ajax({
        url: `${config.apiBaseUrl}/auth/api/user`,
        method: 'GET',
        credentials: 'include', // Include cookies
        success: function (data) {
          if (!data.user || !data.user.id || data.user.role === 'Recruiter') {
            // Redirect to index.html if no session ID is found or the user is a recruiter
            window.location.href = '../index.html';
          }
          userId = data.user.id; // Store the user ID
        },
        error: function (error) {
          // Redirect to index.html if there's an error (e.g., no session)
          window.location.href = '../index.html';
          console.error('Error fetching user ID:', error);
        },
      });
    }
  
    // Function to fetch user data and pre-fill the form
    async function prefillForm() {
      const userId = getQueryParam('userId');
      if (!userId) {
        alert('User ID not found in the URL.');
        return; // Stop execution
      }
  
      try {
        const response = await fetch(`${config.apiBaseUrl}/student/student-info/${userId}`, {
          method: 'GET',
          credentials: 'include',
        });
  
        if (!response.ok) {
          throw new Error('Failed to fetch user data');
        }
  
        const userData = await response.json();
        console.log('User data fetched successfully:', userData);
  
        const isoDate = userData.date_of_birth; // Assuming this is the ISO date string
        const date = new Date(isoDate);
        const formattedDate = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
  
        document.getElementById('first-name').value = userData.first_name || '';
        document.getElementById('last-name').value = userData.last_name || '';
        document.getElementById('date-of-birth').value = formattedDate || '';
        document.getElementById('education').value = userData.education || '';
        document.getElementById('location').value = userData.location || '';
        document.getElementById('language').value = userData.language || '';
        document.getElementById('job_type').value = userData.job_type || 'None';
        document.getElementById('bio').value = userData.bio || '';
      } catch (error) {
        console.error('Error fetching user data:', error);
        alert('Failed to load user data. Please try again.');
      }
    }
  
    // Function to update user info
    async function updateUserInfo() {
      const userId = getQueryParam('userId');
      if (!userId) {
        alert('User ID not found in the URL.');
        return;
      }
  
      const firstName = document.getElementById('first-name').value.trim();
      const lastName = document.getElementById('last-name').value.trim();
      const dateOfBirth = document.getElementById('date-of-birth').value.trim();
      const education = document.getElementById('education').value.trim();
      const location = document.getElementById('location').value.trim();
      const language = document.getElementById('language').value.trim();
      const jobType = document.getElementById('job_type').value.trim();
      const bio = document.getElementById('bio').value.trim();
  
      const requestBody = {
        first_name: firstName,
        last_name: lastName,
        date_of_birth: dateOfBirth, // Use the date directly (assuming it's already in YYYY-MM-DD format)
        education: education,
        current_residence: location,
        language: language,
        job_type: jobType,
        bio: bio,
      };
  
      try {
        const response = await fetch(`${config.apiBaseUrl}/student/edit-profile/${userId}`, {
          method: 'PUT',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(requestBody),
          credentials: 'include',
        });
  
        if (!response.ok) {
          throw new Error('Failed to update user info');
        }
  
        const data = await response.json();
        console.log('User info updated successfully:', data);
  
        alert('Profile updated successfully!');
        window.location.href = `student-yourprofile.html?userId=${userId}`;
      } catch (error) {
        console.error('Error updating user info:', error);
        alert('Failed to update profile. Please try again.');
      }
    }
  
    // Attach the prefillForm function to the page load event
    document.addEventListener('DOMContentLoaded', function () {
      checkSession().then(prefillForm); // Pass prefillForm as a callback
    });
  
    // Attach the updateUserInfo function to the form submission
    document.getElementById('email-form').addEventListener('submit', function (event) {
      event.preventDefault(); // Prevent default form submission
      updateUserInfo();
    });
  </script>
</body>
</html>